---
title: "DSCI 522 Milestone 1"
subtitle: Inferential Analysis for Egg Production
format:
  html:
    toc: true
editor_options:
  markdown:
    wrap: none
---

```{r load libraries, message=FALSE, warning=FALSE}
library(readr)
library(dplyr)
library(infer)
```
# Summary

Type Summary here.

# Introduction

Type Introduction here.

# Methods

## Data

Type here.

## Analysis

Type here.

# Result & Discussion

### Define the Question

Is there a difference in the average number of eggs produced between hatching and table eggs?

### Specify the Hypotheses and Observed Test Statistic

$H_{0}$: The mean number of eggs produced by hens for hatching, $\mu_{hatching}$, is equal to the mean number of eggs produced by hens for table eggs, $\mu_{table}$. Mathematically, $\mu_{hatching} = \mu_{table}$.

$H_{A}$: The mean number of eggs produced by hens for hatching, $\mu_{hatching}$, is NOT equal to the mean number of eggs produced by hens for table eggs, $\mu_{table}$. Mathematically, $\mu_{hatching} \ne \mu_{table}$.

*where* $\mu_{hatching}$ *represents the population mean number of eggs produced by hens for hatching, and* $\mu_{table}$ *represents the population mean number of eggs produced by hens for table eggs.*

The observed test statistic $\delta^{*}$ = $\hat{\mu}_\text{hatching} - \hat{\mu}_\text{table}$

*The estimate* $\delta^{*}$ *is the difference of the observed mean number of eggs for hatching and the observed mean number of eggs for table eggs coming from our egg production data set.*

### Hypothesis Test Using the Permutation Method

```{r}
# read in data
egg_prod <- read_csv("../data/egg-production.csv")
egg_prod
```

```{r warning=FALSE, message=FALSE, tags=c()}
# manipulate the data to calculate the test statistic
n_eggs_set <- egg_prod |>
  group_by(prod_type) |>
  summarise(n = n(),mean_n_eggs = mean(n_eggs))
test_stat <- diff(n_eggs_set$mean_n_eggs)
n_eggs_set
test_stat

# set prod_type as factor
egg_prod <- egg_prod |>
  mutate( prod_type = factor(prod_type))

# implement Hypothesis test using the permutation
set.seed(522)
null_distribution <- egg_prod |>
  specify(formula = n_eggs ~ prod_type) |>
  hypothesize(null = "independence") |>
  generate(reps = 1000, type = "permute") |>
  calculate(stat = "diff in means", order = c("table eggs", "hatching eggs"))

# calculate the p-value
p_value <- null_distribution |>
  get_pvalue(obs_stat = test_stat, direction = "both")

p_value
```

# References

Type here.
